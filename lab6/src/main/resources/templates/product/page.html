<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Product Pagination</title>
    <link rel="stylesheet" th:href="@{/css/app.css}">
</head>
<body>

<th:block th:replace="~{layout/menu}"></th:block>

<div class="container">
    <h3>PRODUCTS</h3>
    <div class="alert success" th:if="${message}" th:text="${message}"></div>



    <form class="container" th:object="${item}">
        <div class="form-row">
            <label for="name">Tên sản phẩm</label>
            <input id="name" th:field="*{name}" placeholder="Product Name"/>
            <small class="error" th:if="${#fields.hasErrors('name')}" th:errors="*{name}"></small>
        </div>
        <div class="form-row">
            <label for="price">Giá</label>
            <input id="price" type="number" step="0.01" th:field="*{price}" placeholder="Price"/>
            <small class="error" th:if="${#fields.hasErrors('price')}" th:errors="*{price}"></small>
        </div>
        <div class="form-row">
            <label for="image">Ảnh</label>
            <input id="image" th:field="*{image}" placeholder="Image URL"/>
        </div>
        <div class="form-row">
            <label for="available">Còn hàng</label>
            <input id="available" type="checkbox" th:field="*{available}"/>
        </div>
        <div class="form-row">
            <label for="category">Loại hàng</label>
            <select id="category" th:field="*{category.id}">
                <option value="" hidden>Chọn loại</option>
                <option th:each="c : ${categories}" th:value="${c.id}" th:text="${c.name}"></option>
            </select>
        </div>
        <div class="actions">
            <input type="hidden" th:field="*{id}"/>
            <button class="btn primary" formaction="/product/create">Create</button>
            <button class="btn" formaction="/product/update">Update</button>
            <a class="btn" th:href="@{|/product/page|}">Reset</a>
            <a class="btn danger" th:if="${item.id}" th:href="@{|/product/delete/${item.id}|}">Delete</a>
        </div>
    </form>

    <form class="toolbar" method="get" th:action="@{/product/page}">
        <input type="text" name="q" th:value="${q}" placeholder="Tìm theo tên">
        <select name="size">
            <option th:selected="${size == 5}" value="5">5</option>
            <option th:selected="${size == 10}" value="10">10</option>
            <option th:selected="${size == 20}" value="20">20</option>
        </select>
        <select name="sort">
            <option th:selected="${sort == 'id'}" value="id">Id</option>
            <option th:selected="${sort == 'name'}" value="name">Name</option>
            <option th:selected="${sort == 'price'}" value="price">Price</option>
            <option th:selected="${sort == 'createDate'}" value="createDate">Date</option>
        </select>
        <select name="dir">
            <option th:selected="${dir == 'asc'}" value="asc">Tăng dần/A-Z</option>
            <option th:selected="${dir == 'desc'}" value="desc">Giảm dần/Z-A</option>
        </select>
        <button class="btn primary" type="submit">Áp dụng</button>
    </form>

<table class="table">
    <tr>
        <th>Id</th>
        <th>Name</th>
        <th>Price</th>
        <th>Date</th>
        <th></th>
    </tr>

    <th:block th:each="item : ${page.content}">
        <tr>
            <td th:text="${item.id}"></td>
            <td th:text="${item.name}"></td>
            <td th:text="${item.price}"></td>
            <td th:text="${item.createDate}"></td>
            <td><a class="btn small" th:href="@{|/product/page?id=${item.id}&q=${q}&size=${size}&sort=${sort}&dir=${dir}|}">Edit</a></td>
        </tr>
    </th:block>
</table>

<div class="pagination">
    <a class="btn" th:classappend="${page.first} ? ' disabled'" th:href="@{|/product/page?p=0&q=${q}&size=${size}&sort=${sort}&dir=${dir}|}">First</a>
    <a class="btn" th:classappend="${page.first} ? ' disabled'" th:href="@{|/product/page?p=${page.number - 1}&q=${q}&size=${size}&sort=${sort}&dir=${dir}|}">Prev</a>
    <span>Trang <span th:text="${page.number + 1}"></span>/<span th:text="${page.totalPages}"></span></span>
    <a class="btn" th:classappend="${page.last} ? ' disabled'" th:href="@{|/product/page?p=${page.number + 1}&q=${q}&size=${size}&sort=${sort}&dir=${dir}|}">Next</a>
    <a class="btn" th:classappend="${page.last} ? ' disabled'" th:href="@{|/product/page?p=${page.totalPages - 1}&q=${q}&size=${size}&sort=${sort}&dir=${dir}|}">Last</a>
</div>
</div>

</body>
</html>
